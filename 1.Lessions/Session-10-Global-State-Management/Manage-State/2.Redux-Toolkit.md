# Redux toolkit

## Bước 1

Cài đặt Redux Toolkit and React-Redux

```bash
npm install @reduxjs/toolkit react-redux
# or
yarn add @reduxjs/toolkit react-redux
```

## Bước 2: Tạo Redux Store

Tạo file `src/redux/store.ts`

```ts
import { configureStore } from "@reduxjs/toolkit";

export default configureStore({
  reducer: {},
});
```

Store là nơi lưu trữ Global State cho toàn bộ ứng dụng

## Bước 3: Cấu hình Provider Redux Store cho React

Tại file main.tsx (React Vite)

```ts
import React from "react";
import ReactDOM from "react-dom";
import "./index.css";
import App from "./App";
import store from "./redux/store";
import { Provider } from "react-redux";

ReactDOM.render(
  <Provider store={store}>
    <App />
  </Provider>,
  document.getElementById("root")
);
```

Về bản chất Provider này là useContext, mang store đến với các component con.

## Bước 4: Tạo một Redux State Slice

`Redux State Slice` được gọi là một lát cắt, thể hiện một tính năng cần sử dụng global state.

Tạo mới một file `src/redux/features/counter/counterSlice.ts`

```ts
import { createSlice } from "@reduxjs/toolkit";

export const counterSlice = createSlice({
  name: "counter", //đặt tên cho slice, không trùng lặp
  initialState: {
    count: 0, //giá trị khởi tạo state count
  },
  reducers: {
    //Hàm tăng count lên 1
    increment: (state) => {
      state.count += 1;
    },
    //Hàm giảm count đi 1
    decrement: (state) => {
      state.count -= 1;
    },
    //Hàm tăng bởi một số tùy chọn
    incrementByAmount: (state, action) => {
      state.count += action.payload;
    },
  },
});

// Export các action ra để các component có thể sử dụng được.
export const { increment, decrement, incrementByAmount } = counterSlice.actions;

export default counterSlice.reducer;
```

Trong đó:

- initialState: là giá trị khởi tạo của các state, có thể có nhiều state và được tổ chức thành object
- reducers: là một object chứa các hàm xử lý logic để thay đổi giá trị của state.

## Bước 5: Thêm Slice Reducers vào Store chung

Ứng dụng của bạn có thể có nhiều Slice, cứ mỗi Slice như vậy bạn cần cấu hình vào Store chung để toàn bộ app có thể truy cập vào Store.

Sửa file `src/redux/store.ts`

```ts
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./features/counter/counterSlice";

export default configureStore({
  reducer: {
    counter: counterReducer, //Gắn counterReducer vào Store chung
  },
});
```

## Bước 6: Sử dụng Redux State cho Các Component

Tạo file `src/redux/features/counter/Counter.tsx`

```tsx
import React from "react";
import { useSelector, useDispatch } from "react-redux";
//Lấy các action từ Slice vào
import { decrement, increment } from "./counterSlice";

export function Counter() {
  //Sử dụng các hooke của react-redux để truy vập vào Store chung
  const count = useSelector((state) => state.counter.count);
  const dispatch = useDispatch();

  return (
    <div>
      <div>
        <button
          aria-label="Increment value"
          onClick={() => dispatch(increment())}
        >
          Increment
        </button>
        <span>{count}</span>
        <button
          aria-label="Decrement value"
          onClick={() => dispatch(decrement())}
        >
          Decrement
        </button>
      </div>
    </div>
  );
}
```

## Bước 7: Import Counter vào App

Import vào và chạy thử
